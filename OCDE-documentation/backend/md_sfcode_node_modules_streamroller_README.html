<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sfcode: streamroller</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sfcode
   </div>
   <div id="projectbrief">An Online Competing and Development Environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">streamroller </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>node.js file streams that roll over when they reach a maximum size, or a date/time. </p><pre class="fragment">    npm install streamroller
</pre> <h1><a class="anchor" id="autotoc_md29069"></a>
usage</h1>
<pre class="fragment">    var rollers = require('streamroller');
    var stream = new rollers.RollingFileStream('myfile', 1024, 3);
    stream.write("stuff");
    stream.end();
</pre><p> The streams behave the same as standard node.js streams, except that when certain conditions are met they will rename the current file to a backup and start writing to a new file.</p>
<h2><a class="anchor" id="autotoc_md29070"></a>
new RollingFileStream(filename [, maxSize, numBackups, options])</h2>
<ul>
<li><code>filename</code> (String)</li>
<li><code>maxSize</code> - the size in bytes to trigger a rollover, if not provided this defaults to MAX_SAFE_INTEGER and the stream will not roll.</li>
<li><code>numBackups</code> - the number of old files to keep</li>
<li><code>options</code> - Object<ul>
<li><code>encoding</code> - defaults to 'utf8'</li>
<li><code>mode</code> - defaults to 0644</li>
<li><code>flags</code> - defaults to 'a' (see <a href="https://nodejs.org/dist/latest-v8.x/docs/api/fs.html#fs_fs_open_path_flags_mode_callback">fs.open</a> for more details)</li>
<li><code>compress</code> - (boolean) defaults to <code>false</code> - compress the backup files using gzip (files will have <code>.gz</code> extension).</li>
<li><code>keepFileExt</code> - (boolean) defaults to <code>false</code> - keep the file original extension. e.g.: <code>abc.log -&gt; abc.1.log</code>.</li>
</ul>
</li>
</ul>
<p>This returns a <code>WritableStream</code>. When the current file being written to (given by <code>filename</code>) gets up to or larger than <code>maxSize</code>, then the current file will be renamed to <code>filename.1</code> and a new file will start being written to. Up to <code>numBackups</code> of old files are maintained, so if <code>numBackups</code> is 3 then there will be 4 files: </p><pre>
     filename
     filename.1
     filename.2
     filename.3
</pre><p> When filename size &gt;= maxSize then: </p><pre>
     filename -&gt; filename.1
     filename.1 -&gt; filename.2
     filename.2 -&gt; filename.3
     filename.3 gets overwritten
     filename is a new file
</pre><p>#</p>
<h1><a class="anchor" id="autotoc_md29071"></a>
new DateRollingFileStream(filename, pattern, options)</h1>
<ul>
<li><code>filename</code> (String)</li>
<li><code>pattern</code> (String) - the date pattern to trigger rolling (see below)</li>
<li><code>options</code> - Object<ul>
<li><code>encoding</code> - defaults to 'utf8'</li>
<li><code>mode</code> defaults to 0644</li>
<li><code>flags</code> defaults to 'a' (see <a href="https://nodejs.org/dist/latest-v8.x/docs/api/fs.html#fs_fs_open_path_flags_mode_callback">fs.open</a> for more details)</li>
<li><code>compress</code> - (boolean) compress the backup files, defaults to false</li>
<li><code>keepFileExt</code> - (boolean) defaults to <code>false</code> - keep the file original extension. e.g.: <code>abc.log -&gt; abc.2013-08-30.log</code>.</li>
<li><code>alwaysIncludePattern</code> - (boolean) extend the initial file with the pattern, defaults to false</li>
</ul>
</li>
</ul>
<p><code>daysToKeep</code> - (integer) if this is greater than 0, then files older than <code>daysToKeep</code> days will be deleted during file rolling.</p>
<p>This returns a <code>WritableStream</code>. When the current time, formatted as <code>pattern</code>, changes then the current file will be renamed to <code>filename.formattedDate</code> where <code>formattedDate</code> is the result of processing the date through the pattern, and a new file will begin to be written. Streamroller uses <a href="http://github.com/nomiddlename/date-format">date-format</a> to format dates, and the <code>pattern</code> should use the date-format format. e.g. with a <code>pattern</code> of <code>".yyyy-MM-dd"</code>, and assuming today is August 29, 2013 then writing to the stream today will just write to <code>filename</code>. At midnight (or more precisely, at the next file write after midnight), <code>filename</code> will be renamed to <code>filename.2013-08-29</code> and a new <code>filename</code> will be created. If <code>options.alwaysIncludePattern</code> is true, then the initial file will be <code>filename.2013-08-29</code> and no renaming will occur at midnight, but a new file will be written to with the name <code>filename.2013-08-30</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
